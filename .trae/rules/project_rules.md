# YeePay AI图像生成项目规则

## 项目概述
本项目是一个基于Vue3 + FastAPI的AI图像生成应用，使用ComfyUI作为后端图像生成引擎，支持Flux模型进行高质量图像生成。

## 技术栈
### 前端
- **框架**: Vue 3.5.18 + Vite 7.0.6
- **UI库**: Ant Design Vue 4.2.6
- **图标**: @ant-design/icons-vue 7.0.1
- **开发工具**: Vue DevTools 8.0.0

### 后端
- **框架**: FastAPI 0.104.1
- **服务器**: Uvicorn 0.24.0
- **图像处理**: Pillow 10.1.0
- **异步HTTP**: aiohttp 3.9.1
- **文件处理**: aiofiles 23.2.1
- **数据验证**: Pydantic 2.5.0
- **认证**: python-jose + passlib

## 项目结构规范

### 目录结构
```
YeePay/
├── frontend/          # Vue前端应用
│   ├── src/
│   │   ├── components/    # Vue组件
│   │   ├── assets/       # 静态资源
│   │   ├── App.vue       # 根组件
│   │   └── main.js       # 入口文件
│   ├── public/           # 公共资源
│   └── package.json      # 前端依赖
├── back/              # Python后端API
│   ├── main.py           # FastAPI应用入口
│   ├── config.py         # 配置管理
│   ├── requirements.txt  # 后端依赖
│   └── *.py             # 业务逻辑文件
├── docs/              # 项目文档
└── .env.example       # 环境变量模板
```

## 开发规范

### 前端开发规范
1. **组件命名**: 使用PascalCase，如`ImageGenerator.vue`
2. **文件组织**: 按功能模块组织组件
3. **样式规范**: 
   - 使用scoped样式避免污染
   - 优先使用Ant Design组件
   - 响应式设计，支持移动端
4. **代码规范**:
   - 使用Composition API
   - 合理使用ref/reactive
   - 组件props要有类型定义

### 后端开发规范
1. **API设计**: 遵循RESTful规范
2. **错误处理**: 统一错误响应格式
3. **配置管理**: 使用环境变量和配置类
4. **异步编程**: 优先使用async/await
5. **数据验证**: 使用Pydantic模型

### 代码质量
1. **注释**: 关键业务逻辑必须有中文注释
2. **命名**: 变量和函数使用有意义的名称
3. **模块化**: 功能拆分，避免单文件过大
4. **错误处理**: 完善的异常捕获和处理

## 部署规范

### 环境配置
1. **开发环境**: 使用本地ComfyUI服务
2. **生产环境**: 配置正确的CORS和API密钥
3. **Docker**: 支持容器化部署

### 文件管理
1. **上传文件**: 限制大小和格式
2. **生成图片**: 定期清理过期文件
3. **日志**: 合理的日志级别和轮转

## 安全规范

1. **输入验证**: 严格验证用户输入
2. **文件上传**: 限制文件类型和大小
3. **API访问**: 可选的API密钥认证
4. **CORS**: 生产环境限制跨域源

## 性能优化

1. **前端**: 
   - 组件懒加载
   - 图片懒加载
   - 合理的缓存策略

2. **后端**:
   - 异步处理
   - 任务队列管理
   - 并发限制

## Git规范

### 分支管理
- `main`: 主分支，稳定版本
- `develop`: 开发分支
- `feature/*`: 功能分支
- `hotfix/*`: 热修复分支

### 提交规范
```
type(scope): description

类型:
- feat: 新功能
- fix: 修复bug
- docs: 文档更新
- style: 样式调整
- refactor: 重构
- test: 测试
- chore: 构建/工具链

示例:
feat(frontend): 添加图像生成进度显示
fix(backend): 修复文件上传大小限制问题
```

## 测试规范

1. **单元测试**: 核心业务逻辑
2. **集成测试**: API接口测试
3. **E2E测试**: 关键用户流程
4. **性能测试**: 图像生成性能

## 文档规范

1. **API文档**: 使用FastAPI自动生成
2. **组件文档**: 重要组件要有使用说明
3. **部署文档**: 详细的部署步骤
4. **更新日志**: 记录版本变更

---

*本规范随项目发展持续更新，所有团队成员应严格遵守。*