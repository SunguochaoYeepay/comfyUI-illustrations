# YeePay Admin æ•°æ®å¤‡ä»½ç³»ç»Ÿ

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

YeePay Admin æ•°æ®å¤‡ä»½ç³»ç»Ÿæä¾›äº†å®Œæ•´çš„æ•°æ®å¤‡ä»½ã€æ¢å¤å’Œç®¡ç†åŠŸèƒ½ï¼Œæ”¯æŒï¼š

- **æ‰‹åŠ¨å¤‡ä»½** - ç®¡ç†å‘˜å¯éšæ—¶åˆ›å»ºå¤‡ä»½
- **è‡ªåŠ¨å¤‡ä»½** - å®šæ—¶è‡ªåŠ¨å¤‡ä»½ç³»ç»Ÿæ•°æ®
- **æ•°æ®æ¢å¤** - ä»å¤‡ä»½æ–‡ä»¶æ¢å¤ç³»ç»Ÿæ•°æ®
- **å¤‡ä»½ç®¡ç†** - å¤‡ä»½æ–‡ä»¶çš„æŸ¥çœ‹ã€ä¸‹è½½ã€åˆ é™¤

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å¯åŠ¨æœåŠ¡

```bash
# å¯åŠ¨Adminåç«¯æœåŠ¡
cd admin/backend
python main.py

# å¯åŠ¨å‰ç«¯æœåŠ¡
cd admin/frontend
npm run dev
```

### 2. è®¿é—®å¤‡ä»½ç®¡ç†

1. æ‰“å¼€æµè§ˆå™¨è®¿é—® `http://localhost:5173`
2. ç™»å½•Adminç³»ç»Ÿ
3. ç‚¹å‡»å·¦ä¾§èœå•çš„"æ•°æ®å¤‡ä»½"
4. è¿›å…¥å¤‡ä»½ç®¡ç†é¡µé¢

### 3. åˆ›å»ºå¤‡ä»½

1. åœ¨"åˆ›å»ºå¤‡ä»½"å¡ç‰‡ä¸­ï¼š
   - è¾“å…¥å¤‡ä»½åç§°
   - é€‰æ‹©å¤‡ä»½ç±»å‹ï¼ˆå…¨é‡/ä¸»æœåŠ¡/AdminæœåŠ¡ï¼‰
   - è®¾ç½®å‹ç¼©çº§åˆ«
   - ç‚¹å‡»"åˆ›å»ºå¤‡ä»½"

2. ç³»ç»Ÿå°†åœ¨åå°æ‰§è¡Œå¤‡ä»½ä»»åŠ¡
3. å¤‡ä»½å®Œæˆåä¼šæ˜¾ç¤ºåœ¨"å¤‡ä»½åˆ—è¡¨"ä¸­

### 4. æ¢å¤å¤‡ä»½

1. åœ¨"æ¢å¤å¤‡ä»½"å¡ç‰‡ä¸­ï¼š
   - é€‰æ‹©è¦æ¢å¤çš„å¤‡ä»½
   - é€‰æ‹©æ¢å¤ç±»å‹
   - ç‚¹å‡»"å¼€å§‹æ¢å¤"
   - ç¡®è®¤æ¢å¤æ“ä½œ

2. ç³»ç»Ÿå°†åœ¨åå°æ‰§è¡Œæ¢å¤ä»»åŠ¡

### 5. è‡ªåŠ¨å¤‡ä»½è®¾ç½®

1. åœ¨"è‡ªåŠ¨å¤‡ä»½è®¾ç½®"å¡ç‰‡ä¸­ï¼š
   - ç‚¹å‡»"æ·»åŠ è‡ªåŠ¨å¤‡ä»½"
   - è®¾ç½®å¤‡ä»½é¢‘ç‡ï¼ˆæ¯æ—¥/æ¯å‘¨/æ¯æœˆï¼‰
   - è®¾ç½®æ‰§è¡Œæ—¶é—´
   - è®¾ç½®ä¿ç•™å¤©æ•°
   - å¯ç”¨è°ƒåº¦

## ğŸ”§ æŠ€æœ¯æ¶æ„

### åç«¯ç»„ä»¶

```
admin/backend/
â”œâ”€â”€ routers/
â”‚   â”œâ”€â”€ backup.py              # å¤‡ä»½APIè·¯ç”±
â”‚   â””â”€â”€ backup_schedule.py     # è‡ªåŠ¨å¤‡ä»½APIè·¯ç”±
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ backup_manager.py      # æ ¸å¿ƒå¤‡ä»½ç®¡ç†å™¨
â”‚   â””â”€â”€ backup_scheduler.py    # è‡ªåŠ¨å¤‡ä»½è°ƒåº¦å™¨
â”œâ”€â”€ models/
â”‚   â””â”€â”€ backup_models.py       # å¤‡ä»½æ•°æ®æ¨¡å‹
â””â”€â”€ schemas/
    â””â”€â”€ backup_schemas.py      # å¤‡ä»½APIæ¨¡å‹
```

### å‰ç«¯ç»„ä»¶

```
admin/frontend/src/
â”œâ”€â”€ views/
â”‚   â””â”€â”€ BackupManagement.vue   # å¤‡ä»½ç®¡ç†ä¸»é¡µé¢
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ BackupCreate.vue       # åˆ›å»ºå¤‡ä»½ç»„ä»¶
â”‚   â”œâ”€â”€ BackupList.vue         # å¤‡ä»½åˆ—è¡¨ç»„ä»¶
â”‚   â”œâ”€â”€ BackupRestore.vue      # æ¢å¤å¤‡ä»½ç»„ä»¶
â”‚   â””â”€â”€ BackupSettings.vue     # å¤‡ä»½è®¾ç½®ç»„ä»¶
â””â”€â”€ utils/
    â””â”€â”€ backupApi.js           # å¤‡ä»½APIè°ƒç”¨
```

## ğŸ“¡ API æ¥å£

### å¤‡ä»½ç®¡ç†æ¥å£

- `POST /api/admin/backup/create` - åˆ›å»ºå¤‡ä»½
- `GET /api/admin/backup/list` - è·å–å¤‡ä»½åˆ—è¡¨
- `GET /api/admin/backup/download/{backup_id}` - ä¸‹è½½å¤‡ä»½
- `POST /api/admin/backup/restore/{backup_id}` - æ¢å¤å¤‡ä»½
- `DELETE /api/admin/backup/{backup_id}` - åˆ é™¤å¤‡ä»½
- `GET /api/admin/backup/status` - è·å–å¤‡ä»½çŠ¶æ€

### è‡ªåŠ¨å¤‡ä»½æ¥å£

- `POST /api/admin/backup/schedule` - åˆ›å»ºè‡ªåŠ¨å¤‡ä»½è°ƒåº¦
- `GET /api/admin/backup/schedule` - è·å–è°ƒåº¦åˆ—è¡¨
- `PUT /api/admin/backup/schedule/{id}` - æ›´æ–°è°ƒåº¦é…ç½®
- `DELETE /api/admin/backup/schedule/{id}` - åˆ é™¤è°ƒåº¦é…ç½®

## ğŸ—‚ï¸ å¤‡ä»½æ•°æ®èŒƒå›´

### ä¸»æœåŠ¡æ•°æ®
- `tasks.db` - ä»»åŠ¡è®°å½•ã€æ”¶è—æ•°æ®
- `uploads/` - ç”¨æˆ·ä¸Šä¼ çš„å›¾ç‰‡
- `outputs/` - ç”Ÿæˆçš„å›¾ç‰‡/è§†é¢‘
- `workflows/` - å·¥ä½œæµé…ç½®æ–‡ä»¶
- `thumbnails/` - ç¼©ç•¥å›¾ç¼“å­˜

### AdminæœåŠ¡æ•°æ®
- `admin.db` - ç”¨æˆ·ã€å·¥ä½œæµã€æ¨¡å‹ã€LoRAé…ç½®
- `uploads/` - ç®¡ç†ç«¯ä¸Šä¼ æ–‡ä»¶
- `outputs/` - ç®¡ç†ç«¯è¾“å‡ºæ–‡ä»¶

### ç³»ç»Ÿé…ç½®
- `docker-compose.yml` - Dockerç¼–æ’æ–‡ä»¶
- `env.production` - ç¯å¢ƒå˜é‡
- `nginx/` - Nginxé…ç½®

## ğŸ”’ å®‰å…¨ç‰¹æ€§

- **æƒé™æ§åˆ¶** - åŸºäºè§’è‰²çš„å¤‡ä»½æƒé™ç®¡ç†
- **æ•°æ®éªŒè¯** - SHA-256æ ¡éªŒå’ŒéªŒè¯
- **æ“ä½œç¡®è®¤** - æ¢å¤æ“ä½œéœ€è¦äºŒæ¬¡ç¡®è®¤
- **æœåŠ¡åœæ­¢** - æ¢å¤å‰è‡ªåŠ¨åœæ­¢ç›¸å…³æœåŠ¡

## ğŸ§ª æµ‹è¯•

### è¿è¡Œæµ‹è¯•è„šæœ¬

```bash
cd admin/backend
python test_backup.py
```

### æ‰‹åŠ¨æµ‹è¯•

1. åˆ›å»ºæµ‹è¯•å¤‡ä»½
2. éªŒè¯å¤‡ä»½æ–‡ä»¶å®Œæ•´æ€§
3. æµ‹è¯•æ¢å¤åŠŸèƒ½
4. éªŒè¯æ•°æ®ä¸€è‡´æ€§

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

### å¤‡ä»½ç›‘æ§

- å¤‡ä»½æˆåŠŸç‡
- å¤‡ä»½å®Œæˆæ—¶é—´
- å¤‡ä»½æ–‡ä»¶å¤§å°
- å­˜å‚¨ç©ºé—´ä½¿ç”¨ç‡

### æ—¥å¿—è®°å½•

```python
# å¤‡ä»½æ“ä½œæ—¥å¿—
logger.info(f"Backup started: {backup_id}")
logger.info(f"Backup completed: {backup_id}")
logger.error(f"Backup failed: {backup_id}")

# æ¢å¤æ“ä½œæ—¥å¿—
logger.info(f"Restore started: {backup_id}")
logger.info(f"Restore completed: {backup_id}")
logger.error(f"Restore failed: {backup_id}")
```

## ğŸš¨ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **å¤‡ä»½å¤±è´¥**
   - æ£€æŸ¥ç£ç›˜ç©ºé—´
   - æ£€æŸ¥æ–‡ä»¶æƒé™
   - æŸ¥çœ‹é”™è¯¯æ—¥å¿—

2. **æ¢å¤å¤±è´¥**
   - éªŒè¯å¤‡ä»½æ–‡ä»¶å®Œæ•´æ€§
   - æ£€æŸ¥æœåŠ¡çŠ¶æ€
   - ç¡®è®¤æ¢å¤ç±»å‹

3. **è‡ªåŠ¨å¤‡ä»½ä¸æ‰§è¡Œ**
   - æ£€æŸ¥è°ƒåº¦å™¨çŠ¶æ€
   - éªŒè¯è°ƒåº¦é…ç½®
   - æŸ¥çœ‹è°ƒåº¦å™¨æ—¥å¿—

### æ—¥å¿—ä½ç½®

- å¤‡ä»½æ—¥å¿—ï¼šæ§åˆ¶å°è¾“å‡º
- é”™è¯¯æ—¥å¿—ï¼šFastAPIé”™è¯¯æ—¥å¿—
- è°ƒåº¦å™¨æ—¥å¿—ï¼šæ§åˆ¶å°è¾“å‡º

## ğŸ”„ ç»´æŠ¤æ“ä½œ

### æ¸…ç†è¿‡æœŸå¤‡ä»½

```bash
# é€šè¿‡APIæ¸…ç†
curl -X POST "http://localhost:8888/api/admin/backup/cleanup?retention_days=30"

# æ‰‹åŠ¨æ¸…ç†
rm -rf backups/backup_*.zip
```

### å¯åŠ¨è°ƒåº¦å™¨æœåŠ¡

```bash
cd admin/backend
python start_backup_scheduler.py
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ï¼š

1. å¤‡ä»½ç³»ç»Ÿæ–‡æ¡£ï¼š`admin/docs/data_backup_system.md`
2. é”™è¯¯æ—¥å¿—è¾“å‡º
3. APIå“åº”çŠ¶æ€ç 

---

*YeePay Admin æ•°æ®å¤‡ä»½ç³»ç»Ÿ v1.0.0*
