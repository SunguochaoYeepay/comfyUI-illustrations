# 管理后台前端开发计划

本文档旨在为基于 Vue 3 + Vite 的管理后台前端应用制定详细的开发计划。

## 核心设计原则

- **默认暗色主题**: 整个管理后台将默认采用暗色系配色方案。
- **极简风格**: 界面（UI）将保持干净、简洁，避免不必要的干扰，专注于核心功能。
- **组件化架构**: 为保证代码的可维护性和可读性，单个文件组件的代码行数不应超过1000行。复杂功能应拆分为更小、可复用的子组件。

## 阶段一：项目初始化与基础搭建

此阶段的目标是完成项目的基础设置，包括清理模板、安装依赖、创建标准目录结构，并完成应用核心入口的配置。

- **任务清单**:
  1.  **清理初始模板**: 删除 Vite 默认安装生成的样板代码和文件（例如 `HelloWorld.vue`、默认样式等）。
  2.  **安装核心依赖**:
      -   `ant-design-vue`: UI 组件库。
      -   `@ant-design/icons-vue`: 图标库。
      -   `vue-router`: 前端路由。
      -   `pinia`: 状态管理。
      -   `axios`: 用于与后端 API 进行 HTTP 通信。
  3.  **创建目录结构**: 按照以下结构组织项目文件，以确保可维护性：
      ```
      src/
      ├── api/          # API 请求模块 (例如: auth.js, images.js)
      ├── assets/       # 静态资源 (例如: 图片, 全局样式)
      ├── components/   # 可复用的 Vue 组件 (例如: PageHeader.vue)
      ├── layouts/      # 布局组件 (例如: BasicLayout.vue)
      ├── router/       # Vue Router 路由配置 (index.js)
      ├── store/        # Pinia 状态管理 (例如: index.js)
      ├── views/        # 页面级组件 (例如: Login.vue, Dashboard.vue)
      ├── App.vue       # 根组件
      └── main.js       # 应用入口文件
      ```
  4.  **配置主入口**:
      -   简化 `App.vue`，仅保留 `<router-view>` 用于渲染路由页面。
      -   配置 `main.js`，引入并使用 `vue-router` 和 `pinia`。

## 阶段二：认证与核心布局

此阶段专注于实现用户认证流程和后台的核心界面布局。

- **任务清单**:
  1.  **创建核心布局**:
      -   创建 `src/layouts/BasicLayout.vue`，作为登录后所有页面的主布局。该布局将使用 Ant Design 组件实现经典的后台界面，包含侧边栏菜单、顶部导航栏和内容区域。
  2.  **实现路由与导航守卫**:
      -   在 `src/router/index.js` 中配置路由，至少包含登录页 (`/login`)、主面板 (`/`) 和一个404页面。
      -   实现一个全局导航守卫，用于保护需要认证的路由。它会检查 Pinia store 或 localStorage 中是否存在认证令牌（token），如果用户未登录，则自动重定向到 `/login`。
  3.  **创建状态管理 (Pinia)**:
      -   在 `src/store/` 目录下创建 `user.js`，用于管理用户的认证状态、令牌和基本信息。
  4.  **封装 API 请求**:
      -   创建 `src/api/auth.js` 模块，用于处理登录、登出等认证相关的 API 请求。
      -   配置一个全局的 `axios` 实例，设置后端 API 的基础 URL (`/api/admin`)，并使用拦截器在每个请求头中自动附加认证令牌。
  5.  **创建登录页面**:
      -   创建 `src/views/Login.vue` 组件，包含一个用于输入用户名和密码的表单。
      -   当用户提交表单时，调用登录 API。如果成功，将令牌保存到 Pinia store 和 localStorage，然后重定向到主面板 (`/dashboard`)。

## 阶段三：核心CRUD模块开发 (以图片管理为例)

本阶段的目标是完成第一个完整的CRUD（创建、读取、更新、删除）功能模块，为后续其他模块的开发建立一个标准范例。

1.  **创建图片管理页面**:
    -   在 `src/views/` 目录下创建 `ImageManagement.vue` 文件。
    -   在 `src/router/index.js` 中添加指向该页面的新路由，并将其作为 `BasicLayout` 的子路由。
    -   在 `src/layouts/BasicLayout.vue` 的侧边栏菜单中，添加入口链接，例如“图片管理”。

2.  **API 对接**:
    -   在 `src/api/` 目录下创建 `images.js` 文件。
    -   在该文件中，封装与后端图片API交互的函数，包括获取图片列表（支持分页）、创建、更新和删除图片记录。

3.  **实现核心CRUD功能**:
    -   **读取 (Read)**: 在 `ImageManagement.vue` 页面加载时，调用API获取图片列表，并使用 Ant Design 的 `Table` 组件进行展示。表格需要包含图片预览、ID、描述、创建时间等字段，并实现分页功能。
    -   **创建 (Create) / 更新 (Update)**: 在页面上添加“新增图片”按钮。点击按钮或表格中的“编辑”按钮时，使用 Ant Design 的 `Modal` 组件弹出一个表单 (`Form`)，用于提交新图片的信息或修改现有图片信息。
    -   **删除 (Delete)**: 在表格的每一行操作列中，添加“删除”按钮。点击后，使用 `Modal.confirm` 弹出确认对话框，防止用户误操作。确认后，调用API删除对应记录并刷新表格数据。

## 阶段四：实现所有核心模块

- **目标**：基于第三阶段建立的开发模式，完成所有剩余模块的开发。
- **模块列表**：
  - **首页 (Dashboard)**: 实现系统状态、任务队列和关键指标的可视化展示。
  - **任务管理 (Task Management)**: 开发任务列表、筛选、搜索和操作（取消、重试）功能。
  - **灵感管理 (Inspiration Management)**: 实现对用户收藏图片的查看和管理。
  - **模型管理 (Model Management)**: 开发 Checkpoint 模型的上传、列表和删除功能。
  - **LoRA管理 (Lora Management)**: 开发 LoRA 模型的上传、列表和删除功能。
  - **生图流管理 (Workflow Management)**: 实现 ComfyUI 工作流的上传、下载、删除和配置功能。
  - **提示词管理 (Prompt Management)**: 开发对正面、负面提示词的增、删、改、查和分类功能。
  - **日志管理 (Log Management)**: 实现管理员操作日志的查看、筛选和搜索功能。
- **实施步骤**：
  - 为每个模块创建独立的 Vue 组件。
  - 在 `src/api` 目录下为各模块创建对应的 API 请求文件。
  - 在 `src/router/index.js` 中为所有模块配置路由。
  - 在侧边栏菜单中添加入口。

## 阶段五：最终确定与优化

-   **UI/UX 打磨**: 确保整个应用具有一致且用户友好的体验。
-   **错误处理**: 实现全局的 API 请求错误处理机制，使用 Ant Design 的 `message` 或 `notification` 组件向用户显示友好的错误提示。
-   **加载状态**: 在表格和表单进行 API 调用期间，添加加载指示器（Loading states）。
-   **代码审查与清理**: 对代码库进行最终审查，进行必要的改进和清理。

这份结构化的计划将指导整个开发过程，确保最终交付一个可扩展、可维护的前端应用。